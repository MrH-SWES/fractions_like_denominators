<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fraction Addition Visualizer</title>
    <style>
        :root {
            --color-1: #4CAF50; /* Green */
            --color-2: #2196F3; /* Blue */
            --bg-color: #f4f4f9;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 { text-align: center; color: #444; }
        p.subtitle { text-align: center; color: #666; margin-bottom: 30px; }

        /* Controls Section */
        .controls {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .fraction-input {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 1.2rem;
            font-weight: bold;
        }

        input[type="number"] {
            width: 60px;
            text-align: center;
            font-size: 1.2rem;
            padding: 5px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }

        input[type="number"]:focus { border-color: var(--color-2); outline: none; }

        .fraction-line {
            width: 100%;
            height: 2px;
            background-color: #333;
            margin: 5px 0;
        }

        .operator { font-size: 2rem; font-weight: bold; color: #555; }

        /* Visualization Containers */
        .vis-section {
            background: var(--card-bg);
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .vis-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .vis-title { font-size: 1.2rem; font-weight: bold; color: #555; }
        
        .explanation {
            background-color: #e8f5e9;
            padding: 10px 15px;
            border-radius: 6px;
            color: #2e7d32;
            font-size: 0.9rem;
        }

        /* --- PIE CHARTS --- */
        .pies-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
            align-items: center;
        }

        .pie-wrapper {
            position: relative;
            width: 150px;
            height: 150px;
        }

        .pie {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px solid #333;
            /* Conic gradient is dynamically set in JS */
            transition: background 0.5s ease;
        }

        /* Grid lines overlay for pie */
        .pie-grid {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
        }

        /* --- FRACTION BARS --- */
        .bars-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        .bar-row {
            display: flex;
            width: 100%;
            max-width: 600px;
            height: 50px;
            border: 2px solid #333;
            border-radius: 4px;
            overflow: hidden;
            background: white;
        }

        .bar-segment {
            flex: 1;
            border-right: 1px solid #333;
            transition: background-color 0.3s;
        }
        .bar-segment:last-child { border-right: none; }

        /* --- NUMBER LINE --- */
        .numberline-container {
            width: 100%;
            overflow-x: auto;
            padding: 20px 0;
        }

        svg { width: 100%; height: 120px; }
        
        text { font-family: sans-serif; font-size: 14px; user-select: none; }
        .tick-line { stroke: #333; stroke-width: 2; }
        .jump-arrow { fill: none; stroke-width: 3; stroke-linecap: round; marker-end: url(#arrowhead); }

        /* Utility classes for coloring */
        .fill-1 { background-color: var(--color-1); }
        .fill-2 { background-color: var(--color-2); }
        .fill-empty { background-color: transparent; }
        
        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 10px;
            font-size: 0.9rem;
        }
        .dot { width: 12px; height: 12px; display: inline-block; border-radius: 50%; margin-right: 5px; }

    </style>
</head>
<body>

    <h1>Interactive Fraction Visualizer</h1>
    <p class="subtitle">Explore why the denominator stays the same when adding fractions.</p>

    <div class="controls">
        <div class="fraction-input">
            <input type="number" id="num1" value="1" min="0" oninput="updateAll()">
            <div class="fraction-line"></div>
            <input type="number" id="den" value="5" min="1" oninput="updateAll()">
        </div>

        <div class="operator">+</div>

        <div class="fraction-input">
            <input type="number" id="num2" value="3" min="0" oninput="updateAll()">
            <div class="fraction-line"></div>
            <input type="number" id="den-display" value="5" disabled style="background:#eee; color:#888">
        </div>

        <div class="operator">=</div>

        <div class="fraction-input">
            <span id="res-num" style="font-size: 1.5rem; color: #333;">4</span>
            <div class="fraction-line"></div>
            <span id="res-den" style="font-size: 1.5rem; color: #333;">5</span>
        </div>
    </div>
    
    <div class="legend">
        <span><span class="dot" style="background:var(--color-1)"></span>First Number</span>
        <span><span class="dot" style="background:var(--color-2)"></span>Second Number</span>
    </div>

    <div class="vis-section">
        <div class="vis-header">
            <div class="vis-title">Fraction Bars</div>
            <div class="explanation">Best for showing that the "container" size doesn't change.</div>
        </div>
        <div class="bars-container" id="bars-container">
            </div>
    </div>

    <div class="vis-section">
        <div class="vis-header">
            <div class="vis-title">Area Model (Pies)</div>
            <div class="explanation">Best for visualizing mixed numbers (totals greater than 1).</div>
        </div>
        <div class="pies-container" id="pies-container">
            </div>
    </div>

    <div class="vis-section">
        <div class="vis-header">
            <div class="vis-title">Number Line</div>
            <div class="explanation">Best for seeing addition as "distance traveled".</div>
        </div>
        <div class="numberline-container" id="numberline-container">
            </div>
    </div>

<script>
    function updateAll() {
        // 1. Get Values
        const num1 = parseInt(document.getElementById('num1').value) || 0;
        const num2 = parseInt(document.getElementById('num2').value) || 0;
        const den = parseInt(document.getElementById('den').value) || 1;

        // Sync the disabled denominator input
        document.getElementById('den-display').value = den;

        // Calculate Result
        const totalNum = num1 + num2;
        
        // Update Result Text
        document.getElementById('res-num').innerText = totalNum;
        document.getElementById('res-den').innerText = den;

        // 2. Determine how many "wholes" we need to draw
        // Even if total is 0, we draw at least 1 whole for context
        const wholesNeeded = Math.max(1, Math.ceil(totalNum / den));

        // 3. Render Models
        renderBars(num1, num2, den, wholesNeeded);
        renderPies(num1, num2, den, wholesNeeded);
        renderNumberLine(num1, num2, den, wholesNeeded);
    }

    // --- RENDER BARS ---
    function renderBars(n1, n2, d, wholes) {
        const container = document.getElementById('bars-container');
        container.innerHTML = ''; // Clear

        let count1 = n1;
        let count2 = n2;

        for (let w = 0; w < wholes; w++) {
            const row = document.createElement('div');
            row.className = 'bar-row';
            
            for (let i = 0; i < d; i++) {
                const seg = document.createElement('div');
                seg.className = 'bar-segment';
                
                // Coloring Logic
                if (count1 > 0) {
                    seg.style.backgroundColor = 'var(--color-1)';
                    count1--;
                } else if (count2 > 0) {
                    seg.style.backgroundColor = 'var(--color-2)';
                    count2--;
                } else {
                    seg.style.backgroundColor = 'transparent';
                }
                row.appendChild(seg);
            }
            container.appendChild(row);
        }
    }

    // --- RENDER PIES ---
    function renderPies(n1, n2, d, wholes) {
        const container = document.getElementById('pies-container');
        container.innerHTML = ''; 

        let count1 = n1;
        let count2 = n2;

        for (let w = 0; w < wholes; w++) {
            const wrapper = document.createElement('div');
            wrapper.className = 'pie-wrapper';

            // 1. Calculate degrees for each section in this specific pie
            // A whole pie has 'd' slots.
            // We fill slots with Color 1, then Color 2, then Empty.
            
            let segments = [];
            let currentAngle = 0;
            const degPerUnit = 360 / d;

            for(let i=0; i<d; i++) {
                let color = 'transparent';
                if (count1 > 0) { color = 'var(--color-1)'; count1--; }
                else if (count2 > 0) { color = 'var(--color-2)'; count2--; }
                else { color = '#fff'; } // Empty

                // Build gradient string parts
                // "color startDeg endDeg"
                segments.push(`${color} ${currentAngle}deg ${currentAngle + degPerUnit}deg`);
                currentAngle += degPerUnit;
            }

            const pie = document.createElement('div');
            pie.className = 'pie';
            pie.style.background = `conic-gradient(${segments.join(', ')})`;
            
            // Create Grid Lines (SVG overlay)
            const svgNS = "http://www.w3.org/2000/svg";
            const svg = document.createElementNS(svgNS, "svg");
            svg.setAttribute("class", "pie-grid");
            svg.setAttribute("viewBox", "0 0 100 100");
            
            // Draw lines from center
            for(let i=0; i<d; i++) {
                const angle = (i * 360 / d) * (Math.PI / 180); // Rads
                // Center is 50,50. Radius is 50.
                const x2 = 50 + 50 * Math.cos(angle - Math.PI/2); // -PI/2 to start at top
                const y2 = 50 + 50 * Math.sin(angle - Math.PI/2);
                
                const line = document.createElementNS(svgNS, "line");
                line.setAttribute("x1", "50");
                line.setAttribute("y1", "50");
                line.setAttribute("x2", x2);
                line.setAttribute("y2", y2);
                line.setAttribute("stroke", "#333");
                line.setAttribute("stroke-width", "1");
                svg.appendChild(line);
            }

            // Circle Border
            const circle = document.createElementNS(svgNS, "circle");
            circle.setAttribute("cx", "50");
            circle.setAttribute("cy", "50");
            circle.setAttribute("r", "49");
            circle.setAttribute("fill", "none");
            circle.setAttribute("stroke", "#333");
            circle.setAttribute("stroke-width", "2");
            svg.appendChild(circle);

            wrapper.appendChild(pie);
            wrapper.appendChild(svg);
            container.appendChild(wrapper);
        }
    }

    // --- RENDER NUMBER LINE ---
    function renderNumberLine(n1, n2, d, wholes) {
        const container = document.getElementById('numberline-container');
        container.innerHTML = '';
        
        // Setup Dimensions
        const width = Math.max(600, wholes * 300); // Dynamic width
        const height = 120;
        const margin = 30;
        const effectiveWidth = width - (margin * 2);
        
        // Unit Size (pixels per 1 whole)
        const unitPx = effectiveWidth / wholes; 
        const tickPx = unitPx / d; // Pixels per fraction unit (e.g. 1/5)

        const svgNS = "http://www.w3.org/2000/svg";
        const svg = document.createElementNS(svgNS, "svg");
        svg.setAttribute("width", width);
        svg.setAttribute("height", height);

        // Define Arrow Marker
        const defs = document.createElementNS(svgNS, "defs");
        const marker = document.createElementNS(svgNS, "marker");
        marker.setAttribute("id", "arrowhead");
        marker.setAttribute("markerWidth", "10");
        marker.setAttribute("markerHeight", "7");
        marker.setAttribute("refX", "9");
        marker.setAttribute("refY", "3.5");
        marker.setAttribute("orient", "auto");
        const polygon = document.createElementNS(svgNS, "polygon");
        polygon.setAttribute("points", "0 0, 10 3.5, 0 7");
        polygon.setAttribute("fill", "#555");
        marker.appendChild(polygon);
        defs.appendChild(marker);
        svg.appendChild(defs);

        // Draw Base Line
        const baseLine = document.createElementNS(svgNS, "line");
        baseLine.setAttribute("x1", margin);
        baseLine.setAttribute("y1", height/2 + 20);
        baseLine.setAttribute("x2", width - margin);
        baseLine.setAttribute("y2", height/2 + 20);
        baseLine.setAttribute("stroke", "#333");
        baseLine.setAttribute("stroke-width", "2");
        svg.appendChild(baseLine);

        // Draw Ticks & Labels
        for (let i = 0; i <= wholes * d; i++) {
            const x = margin + (i * tickPx);
            const isWhole = i % d === 0;
            
            const tick = document.createElementNS(svgNS, "line");
            tick.setAttribute("x1", x);
            tick.setAttribute("x2", x);
            tick.setAttribute("y1", height/2 + 20);
            tick.setAttribute("y2", height/2 + (isWhole ? 35 : 28));
            tick.setAttribute("stroke", "#333");
            tick.setAttribute("stroke-width", isWhole ? 3 : 1);
            svg.appendChild(tick);

            if (isWhole) {
                const text = document.createElementNS(svgNS, "text");
                text.setAttribute("x", x);
                text.setAttribute("y", height/2 + 55);
                text.setAttribute("text-anchor", "middle");
                text.textContent = i / d;
                svg.appendChild(text);
            }
        }

        // Draw Jump 1 (Green)
        if (n1 > 0) {
            const startX = margin;
            const endX = margin + (n1 * tickPx);
            const path = document.createElementNS(svgNS, "path");
            // Quadratic Bezier curve for jump
            const midX = (startX + endX) / 2;
            path.setAttribute("d", `M ${startX} ${height/2+15} Q ${midX} ${height/2 - 40} ${endX} ${height/2+15}`);
            path.setAttribute("stroke", "var(--color-1)");
            path.setAttribute("fill", "none");
            path.setAttribute("stroke-width", "3");
            path.setAttribute("marker-end", "url(#arrowhead)");
            svg.appendChild(path);
        }

        // Draw Jump 2 (Blue) - Starts where Green ended
        if (n2 > 0) {
            const startX = margin + (n1 * tickPx);
            const endX = startX + (n2 * tickPx);
            const path = document.createElementNS(svgNS, "path");
            const midX = (startX + endX) / 2;
            // Higher arc if it overlaps significantly, or same height
            path.setAttribute("d", `M ${startX} ${height/2+15} Q ${midX} ${height/2 - 40} ${endX} ${height/2+15}`);
            path.setAttribute("stroke", "var(--color-2)");
            path.setAttribute("fill", "none");
            path.setAttribute("stroke-width", "3");
            path.setAttribute("marker-end", "url(#arrowhead)");
            svg.appendChild(path);
        }

        container.appendChild(svg);
    }

    // Init
    updateAll();

</script>
</body>
</html>
